---
title: "Practical 2 - Conjugacy, prediction and Monte Carlo simulation"
author: "Spatial and Spatio-Temporal Bayesian Models with `R-INLA`"
output: 
  html_document:
    css: practical.css
    toc: true
    toc_float: true
---

\pagenumbering{gobble} 
\pagenumbering{arabic} 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, fig.align = "center", class.source='klippy')
```
```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy(position = c('top', 'right'),color = 'darkred',
               tooltip_message = 'Click to copy', tooltip_success = 'Done')
```

# 1. Tune your Beta prior 

In each situation below, tune a Beta$(a,b)$ model that accurately reflects the given prior information. In many cases, there’s no single **right** answer, but rather multiple **reasonable** answers. Justify your answer.

  a. A scientist has created a new test for a rare disease. They expect that the test is accurate 80% of the time with a variance of 0.05

  b. Your friend applied to a job and tells you: *I think I have a 40% chance of getting the job, but I’m pretty unsure.* When pressed further, they put their chances between 20% and 60%. Hint: this is similar to the example we have seen in the lecture this morning.

  c. Your Aunt Jo is a successful mushroom hunter. She boasts: *I expect to find enough mushrooms to feed myself and my co-workers at the auto-repair shop 90% of the time, but if I had to give you a likely range it would be between 85% and 95% of the time.*

# 2. Beta prior with no information

You want to specify a Beta prior for a situation in which you have no idea about some parameter $\theta$. You think  
$\theta$ is equally likely to be anywhere between 0 and 1.

  a. Specify and plot the appropriate Beta prior model.
  
  b. What is the mean of the Beta prior that you specified? Explain why that does or does not align with having no clue.
  
  c. What is the standard deviation of the Beta prior that you specified?
  
**HINT**: Use the functions `plot_beta()` and `summary_beta()` from the R package `bayesrules` to help you. Just note that in those functions our $\theta$ is called $\pi$.

# 3. Tune your Gamma prior

In each situation below, tune a $Gamma(a,b)$ model for $\lambda$

  a. The mean of $\lambda$ is 4 and the variance is 12.
  
  b. The mean of  $\lambda$ is 22 and the variance is 3.
  
# 4. Gamma with no information
Let $\lambda$ be the incidence ratio of Dengue in a Brazilian municipality in a specific year. We observe   
$y=24$ cases and know that the Expected value for that municipality is $N=20$.

  a. Specify a prior assuming we have no information on $\lambda$
  
  b. Why is the Poisson a reasonable choice for our data $Y$?
  
  c. Identify the posterior distribution for $\lambda$ 
  
  d. Plot the prior pdf, likelihood function (use the function `plot_poisson_likelihood()`), and posterior pdf of  $\lambda$. Describe the evolution in your understanding of $\lambda$ from the prior to the posterior.


# 5. Beta-Binomial model

A local authority wants to study the efficacy of a public health intervention to encourage more children to walk to school. They collect data on one primary school and see that 130 out of 200 children walked regularly to school over the winter term. From the previous years they expect the proportion of children walking to school to be between 30% and 40%.

  a. Use the information from previous years to specify a prior for $\theta$ (proportion of children regularly walking to school)
  
  b. What is the data distribution?
  
  c. What is the posterior for $\theta$? 
  
  d. Would you conclude that the policy has been successful? Justify your answer.
  
  e. Assuming that the policy will be extended to all the primary schools in the local authorities over the next year, and knowing that the total number of children of primary school age are 1500, what would be the distribution of the number of children that will be regularly walking to school?

# 6. Gamma-Poisson model

A biologist hires you to study the density of a certain insect in the local region. Their prior idea about $\theta$, the number of insects per  
$m^2$ area, is well captured by a Gamma model with an expected value of $0.5$ insects per  $m^2$ and a variance of $0.25$ insects per $m^2$. You then go out to inspect 5 separate $m^2$ areas of a nearby field. You count 3, 2, 5, 1, 2 insects.

  a. What model, Normal or Poisson, should you use to model the dependence of your insect count data on the underlying insect density $\theta$? Explain why.
  
  b. Plot the prior probability function and posterior probability function of insect density  $\theta$
  
  c. What is the posterior mean and standard deviation of the insect density?
  
  d. Calculate the probability that the insect density is larger than 2 per $m^2$ (you can use an analytical approach or the MC simulative approach).

