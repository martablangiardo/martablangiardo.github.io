library(INLA)
help("inla")
help("control.predictor")
help("control.compute")
1830/5
3/0.75
xaringan:::inf_mr()
set.seed(1234)
library(truncnorm)
noise.high<- rtruncnorm(600,a=50,b=Inf,60,5)
noise.low<- runif(400,0,49)
noise.tot<- c(noise.high,noise.low)
iid <- rnorm(1000,0,0.1)
id.high<-noise.tot>=50
id.low<-noise.tot<50
#If the true relationship is linear across the entire range of noise values
#health
mu<- log(10) -5 + 0.1*noise.tot + iid
y<-rpois(1000,exp(mu))
glm(y~noise.tot,family="poisson",offset=rep(log(10),1000))
plot(noise.tot,mu)
#Subsetting on the ones with noise above 49
y.high<- y[id.high]
length(y.high)
glm(y.high~noise.high,family="poisson",offset=rep(log(10),length(y.high)))
####################################
#If there is a threshold on the noise level
mu.high<- log(5) -5 + 0.1*noise.high + iid[id.high]
mu.low<- log(5) -5 + 0.01*noise.low + iid[id.low] + iid[id.low]
mu<-c(mu.high,mu.low)
plot(noise.tot,mu)
####################################
#If there is a threshold on the noise level
mu.high<- log(5) -5 + 0.1*noise.high + iid[id.high]
mu.low<- log(5) -5 + 0.01*noise.low + 3*iid[id.low]
mu<-c(mu.high,mu.low)
plot(noise.tot,mu)
y.new <- c(rpois(1000, exp(mu)))
glm(y.new~noise.tot,family="poisson",offset=rep(log(5),1000))
#Subsetting on the ones with noise above 49
y.high<- y.new[id.high]
glm(y.high~noise.tot[id.high],family="poisson",offset=rep(log(10),length(y.high)))
####################################
#If there is a threshold on the noise level
mu.high<- log(5) -5 + 0.1*noise.high + iid[id.high]
mu.low<- log(5) -5 + 5*iid[id.low]
mu<-c(mu.high,mu.low)
plot(noise.tot,mu)
y.new <- c(rpois(1000, exp(mu)))
glm(y.new~noise.tot,family="poisson",offset=rep(log(5),1000))
#Subsetting on the ones with noise above 49
y.high<- y.new[id.high]
glm(y.high~noise.tot[id.high],family="poisson",offset=rep(log(10),length(y.high)))
plot(noise.tot[id.high],mu.high)
2600/21
help(cov)
help(mrnorm)
help("hist")
options(timeout=600)
install.packages("tidyverse")
install.packages("here")
install.packages("rmarkdown")
install.packages('BCEA')
install.packages('rjags')
install.packages("R2OpenBUGS")
install.packages("R2jags")
install.packages('INLA', repos='https://inla.r-inla-download.org/R/stable')
remotes::install_github("giabaio/bmhe_utils")
library(R2OpenBUGS)
library(R2Openbugs)
library(R2OpenBugs)
options(timeout=600)
install.packages("tidyverse")
install.packages("here")
install.packages("rmarkdown")
install.packages('BCEA')
install.packages('rjags')
install.packages("R2OpenBUGS")
install.packages("R2jags")
install.packages('INLA', repos='https://inla.r-inla-download.org/R/stable')
remotes::install_github("giabaio/bmhe_utils")
library(R2OpenBUGS)
library(R2jags)
install.packages('INLA', repos='https://inla.r-inla-download.org/R/stable')
remotes::install_github("giabaio/bmhe_utils")
install.packages('INLA', repos='https://inla.r-inla-download.org/R/stable')
remotes::install_github("giabaio/bmhe_utils")
library(INLA)
install.packages("foreach","sp")
install.packages("foreach","sp")
install.packages('INLA', repos='https://inla.r-inla-download.org/R/stable')
library(INLA)
install.packages('INLA', repos='https://inla.r-inla-download.org/R/testing')
library(INLA)
installed.packages("sp")
installed.packages("sp")
library(INLA)
installed.package("sp")
install.package("sp")
install.packages("sp")
library(INLA)
install.package("inlabru")
install.packages("inlabru")
install.packages("inlabru")
library(INLA)
remotes::install_github("giabaio/bmhe_utils")
remotes::install_github("giabaio/bmhe_utils")
libPaths
.libPaths
.libPaths()
install.packages("remotes")
remotes::install_github("giabaio/bmhe_utils")
remotes::install_github("giabaio/survHE")
remotes::install_github("giabaio/survHEinla")
exp(-0.1)
library(INLA)
help(control.compute)
remotes::install_github('mitchelloharawild/icons')
install.packages("tikzDevice")
install.packages("kableExtra")
install.packages("RefManageR")
install.packages("RefManageR")
library(bkmr)
set.seed(111)
dat <- SimData(n = 50, M = 4)
y <- dat$y
Z <- dat$Z
X <- dat$X
X
X<- rbinom(50,3,0.4)
X
X<- X+1
X
set.seed(111)
fitkm <- kmbayes(y = y, Z = Z, X = X, iter = 10000, verbose = FALSE, varsel = TRUE)
TracePlot(fit = fitkm, par = "beta")
TracePlot(fit = fitkm, par = "beta", comp=2)
set.seed(111)
fitkm <- kmbayes(y = y, Z = Z, X = as.factor(X), iter = 10000, verbose = FALSE, varsel = TRUE)
install.packages("fastDummies")
library(fastDummies)
library(fastDummies)
dummy_cols(X)
X.cat=dummy_cols(X)
set.seed(111)
fitkm <- kmbayes(y = y, Z = Z, X = X.cat[,3:5], iter = 10000, verbose = FALSE, varsel = TRUE)
TracePlot(fit = fitkm, par = "beta")
TracePlot(fit = fitkm, par = "beta2")
TracePlot(fit = fitkm, par = "beta", comp=2)
library(INLA)
help(inla)
help(control.inla)
library(INLA)
setwd("C:/Users/magb/Dropbox/Grants/2023submissions/AI_Health/MRC/Noro")
xx<- read.csv("20231019_NoV_data_for_ICL.csv")
dim(xx)
head(xx)
unique(xx$site_name)
head(xx)
unique(xx$sample_collection_date_time)
unique(xx$year)
unique(xx$sample_year)
unique(cbind(xx$sample_year,xx$sample_month))
library(candela)
install.packages("candela")
remotes::install_github("giocomai/ganttrify")
library(ganttrify)
ganttrify(project = ganttrify::test_project,
spots = ganttrify::test_spots,
project_start_date = "2021-03",
font_family = "Roboto Condensed")
test_project
test_project[1,1] <- "WP1: Data preparation for syndromic and clinical surveillance"
test_project[2,1] <- "WP2: Wastewater modelling and prediction (objective 1.1-1.3)"
test_project[3,1] <- "WP1: Probabilistic framework building  (objective 3.1-3.2)"
test_project[4,1] <- "WP3: estimating the relationship between wastewater and traditional disease metrics (objective 2)"
test_project[5,1] <- "WP1-WP3: Application to the COVID-19 case study in England and model testing"
test_project[6,1] <- "WP1-WP3: Application to the norovirus case study and model testing"
test_project[7,1] <- "WP1: optimising sampling strategy (objective 4)"
test_project[8,1] <- "WP1: extension to multiple diseases (objective 5)"
test_project[9,1] <- "WP4: workshops"
test_project[10,1] <- "Paper writing and dissemination"
test_project[11,1] <- "Code and documentation preparation for github"
test_project
test_project$activity
library(ganttrify)
test_project
test_project[1,1] <- "WP1"
test_project[2,1] <- "WP2"
test_project[3,1] <- "WP1"
test_project[4,1] <- "WP3"
test_project[5,1] <- "Case study 1"
test_project[6,1] <- "Case study 2"
test_project[7,1] <- "WP1"
test_project[8,1] <- "WP1 "
test_project[9,1] <- "WP4"
test_project[10,1] <- "WP4"
test_project[11,1] <- "WP4"
test_project[12,1] <- "WP1-P4"
test_project[13,1] <- "WP4"
test_project[1,2] <- "Data preparation for syndromic and clinical surveillance"
test_project[2,2] <- "Wastewater modelling and prediction (objective 1.1-1.3)"
test_project[3,2] <- "Probabilistic framework building  (objective 3.1-3.2)"
test_project[4,2] <- "Estimating the relationship between wastewater and traditional disease metrics (objective 2)"
test_project[5,2] <- "Application to the COVID-19 case study in England and model testing"
test_project[6,2] <- "Application to the norovirus case study and model testing"
test_project[7,2] <- "Optimising sampling strategy (objective 4)"
test_project[8,2] <- "Extension to multiple diseases (objective 5)"
test_project[9,2] <- "Workshops"
test_project[10,2] <- "Workshops"
test_project[11,2] <- "Workshops"
test_project[12,2] <- "Paper writing and dissemination"
test_project[13,2] <- "Code and documentation preparation for github"
test_project[,3] <- c(1,1,4,13,7,10,15,20,6,18,24,8,6)
test_project[,4] <- c(3,6,15,15,14,17,20,24,6,18,24,24,24)
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
project_start_date = "2024-10",
size_text_relative = 1.2,
mark_quarters = TRUE,
font_family = "Roboto Condensed")
warnings()
test_project[1,1] <- "WP1"
test_project[2,1] <- "WP1"
test_project[3,1] <- "WP1"
test_project[4,1] <- "WP1 "
test_project[5,1] <- "WP2"
test_project[6,1] <- "WP3"
test_project[7,1] <- "Case study 1"
test_project[8,1] <- "Case study 2"
test_project[9,1] <- "WP4"
test_project[10,1] <- "WP4"
test_project[11,1] <- "WP4"
test_project[12,1] <- "WP4"
test_project[13,1] <- "WP4"
test_project[1,2] <- "Data preparation for syndromic and clinical surveillance"
test_project[2,2] <- "Probabilistic framework building  (objective 3.1-3.2)"
test_project[3,2] <- "Optimising sampling strategy (objective 4)"
test_project[4,2] <- "Extension to multiple diseases (objective 5)"
test_project[5,2] <- "Wastewater modelling and prediction (objective 1.1-1.3)"
test_project[6,2] <- "Estimating the relationship between wastewater and traditional disease metrics (objective 2)"
test_project[7,2] <- "Application to the COVID-19 case study in England and model testing"
test_project[8,2] <- "Application to the norovirus case study and model testing"
test_project[9,2] <- "Workshops"
test_project[10,2] <- "Workshops"
test_project[11,2] <- "Workshops"
test_project[12,2] <- "Paper writing and dissemination"
test_project[13,2] <- "Code and documentation preparation for github"
test_project[,3] <- c(1,1,4,13,7,10,15,20,6,18,24,8,6)
test_project[,4] <- c(3,6,15,15,14,17,20,24,6,18,24,24,24)
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
project_start_date = "2024-10",
size_text_relative = 1.2,
mark_quarters = TRUE,
font_family = "Roboto Condensed")
help("ganttrify")
test_project
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
#          project_start_date = "2024-10",
size_text_relative = 1.1,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
test_project[1,1] <- "WP1"
test_project[2,1] <- "WP1"
test_project[3,1] <- "WP1"
test_project[4,1] <- "WP1"
test_project[5,1] <- "WP2"
test_project[6,1] <- "WP3"
test_project[7,1] <- "Case study 1"
test_project[8,1] <- "Case study 2"
test_project[9,1] <- "WP4"
test_project[10,1] <- "WP4"
test_project[11,1] <- "WP4"
test_project[12,1] <- "WP4"
test_project[13,1] <- "WP4"
test_project[1,2] <- "Data preparation"
test_project[2,2] <- "Probabilistic framework building  (objective 3.1-3.2)"
test_project[3,2] <- "Optimising sampling strategy (objective 4)"
test_project[4,2] <- "Extension to multiple diseases (objective 5)"
test_project[5,2] <- "Wastewater modelling and prediction (objective 1.1-1.3)"
test_project[6,2] <- "Relationship between ww and disease metrics (objective 2)"
test_project[7,2] <- "Application to the COVID-19 case study (England)"
test_project[8,2] <- "Application to the COVID-19 case study (Wales)"
test_project[9,2] <- "Workshops"
test_project[10,2] <- "Workshops"
test_project[11,2] <- "Workshops"
test_project[12,2] <- "Paper writing and dissemination"
test_project[13,2] <- "Code & doc prer for github"
test_project[,3] <- c(1,1,4,13,7,10,15,19,6,17,23,8,6)
test_project[,4] <- c(3,6,15,15,14,17,20,24,6,18,24,24,24)
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
#          project_start_date = "2024-10",
size_text_relative = 1.1,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
#          project_start_date = "2024-10",
size_text_relative = 1.1,
month_breaks = 3,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
#          project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "#8DD3C7")')
month_breaks = 3,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
#          project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "#8DD3C7"),
month_breaks = 3,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
anttrify(project = test_project,
#          spots = ganttrify::test_spots,
#          project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "blue"),
month_breaks = 3,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
#          project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "blue"),
month_breaks = 3,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
#          project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "blue"),
month_breaks = 2,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "blue"),
month_breaks = 2,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
test_project[1,1] <- "WP1"
test_project[2,1] <- "WP1"
test_project[3,1] <- "WP1"
test_project[4,1] <- "WP1"
test_project[5,1] <- "WP2"
test_project[6,1] <- "WP3"
test_project[7,1] <- "Case study 1"
test_project[8,1] <- "Case study 2"
test_project[9,1] <- "WP4"
test_project[10,1] <- "WP4"
test_project[11,1] <- "WP4"
test_project[12,1] <- "WP4"
test_project[13,1] <- "WP4"
test_project[1,2] <- "Data preparation"
test_project[2,2] <- "Probabilistic framework building  (objective 3.1-3.2)"
test_project[3,2] <- "Optimising sampling strategy (objective 4)"
test_project[4,2] <- "Extension to multiple diseases (objective 5)"
test_project[5,2] <- "Wastewater modelling and prediction (objective 1.1-1.3)"
test_project[6,2] <- "Relationship between ww and disease metrics (objective 2)"
test_project[7,2] <- "Application to the COVID-19 case study (England)"
test_project[8,2] <- "Application to the COVID-19 case study (Wales)"
test_project[9,2] <- "Workshops"
test_project[10,2] <- "Workshops"
test_project[11,2] <- "Workshops"
test_project[12,2] <- "Paper writing and dissemination"
test_project[13,2] <- "Code & doc prer for github"
test_project[,3] <- c(1,1,4,18,7,10,12,19,7,17,23,8,6)
test_project[,4] <- c(3,8,18,24,14,17,18,24,6,18,24,24,24)
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "blue"),
month_breaks = 2,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
test_project[1,1] <- "WP1"
test_project[2,1] <- "WP1"
test_project[3,1] <- "WP1"
test_project[4,1] <- "WP1"
test_project[5,1] <- "WP2"
test_project[6,1] <- "WP3"
test_project[7,1] <- "Case study 1"
test_project[8,1] <- "Case study 2"
test_project[9,1] <- "WP4"
test_project[10,1] <- "WP4"
test_project[11,1] <- "WP4"
test_project[12,1] <- "WP4"
test_project[13,1] <- "WP4"
test_project[1,2] <- "Data preparation"
test_project[2,2] <- "Probabilistic framework building  (objective 3.1-3.2)"
test_project[3,2] <- "Optimising sampling strategy (objective 4)"
test_project[4,2] <- "Extension to multiple diseases (objective 5)"
test_project[5,2] <- "Wastewater modelling and prediction (objective 1.1-1.3)"
test_project[6,2] <- "Relationship between ww and disease metrics (objective 2)"
test_project[7,2] <- "Application to the COVID-19 case study (England)"
test_project[8,2] <- "Application to the COVID-19 case study (Wales)"
test_project[9,2] <- "Workshops"
test_project[10,2] <- "Workshops"
test_project[11,2] <- "Workshops"
test_project[12,2] <- "Paper writing and dissemination"
test_project[13,2] <- "Code & doc prer for github"
test_project[,3] <- c(1,1,4,18,3,10,12,19,7,17,23,8,6)
test_project[,4] <- c(3,8,18,24,12,17,18,24,6,18,24,24,24)
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "blue"),
month_breaks = 2,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
test_project[1,2] <- "Data preparation"
test_project[2,2] <- "Probabilistic framework building  (objective 3.1-3.2)"
test_project[3,2] <- "Optimising sampling strategy (objective 4)"
test_project[4,2] <- "Extension to multiple diseases (objective 5)"
test_project[5,2] <- "Wastewater modelling and prediction (objective 1.1-1.3)"
test_project[6,2] <- "Relationship between ww and disease metrics (objective 2)"
test_project[7,2] <- "Application to the COVID-19 case study (England)"
test_project[8,2] <- "Application to the COVID-19 case study (Wales)"
test_project[9,2] <- "Workshops"
test_project[10,2] <- "Workshops"
test_project[11,2] <- "Workshops"
test_project[12,2] <- "Paper writing and dissemination"
test_project[13,2] <- "Code & doc prer for github"
test_project[,3] <- c(1,1,4,18,3,10,15,19,7,17,23,8,6)
test_project[,4] <- c(3,8,18,24,12,17,20,24,6,18,24,24,24)
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "blue"),
month_breaks = 2,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
test_project[,3] <- c(1,1,4,18,3,10,15,19,6,18,24,8,6)
test_project[,4] <- c(3,8,18,24,12,17,20,24,6,18,24,24,24)
ganttrify(project = test_project,
#          spots = ganttrify::test_spots,
project_start_date = "2024-10",
size_text_relative = 1.1,
colour_palette = c("#6ACCEA", "#00FFB8", "#B90000", "#6C919C", "#BEBADA", "blue"),
month_breaks = 2,
mark_quarters = FALSE,
font_family = "Roboto Condensed")
1460/100*5
1460/100*5*2
1460/100*7.5*1.5
1460/100*7.5*1.25
15/24
15/12
16/12
1460/100*7.5*1.3
install.packages("INLA", repos="http://www.math.ntnu.no/inla/R/stable")
install.packages("INLA",repos=c(getOption("repos"),INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)
setwd("C:/Users/magb/Dropbox/Books/INLABook/ShortCourse/VIBASS/Session3.1")
utils::install. packages("rmarkdown")
utils::install.packages("rmarkdown")
unlink("index_cache", recursive = TRUE)
install.packages("formatR")
